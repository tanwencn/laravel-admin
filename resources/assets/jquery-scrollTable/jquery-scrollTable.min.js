(function($){var defaults={tableHeight:0};var scrollBarWidth=15,fixedTableWidth;$.fn.scrollTableBody=function(options){defaults=$.extend(defaults,this.data());options=$.extend(defaults,options);var table=this;wrapTable(table,options);alignColumns(table);var resizeAlignFunction=function(){alignOnResize(table)};var canDebounce=typeof _=="function"&&typeof _.debounce=="function";if(canDebounce){resizeAlignFunction=_.debounce(resizeAlignFunction,150)}$(window).resize(resizeAlignFunction)};function wrapTable(table,options){var existingClasses=table.attr("class");var existingMarginBottom=table.css("margin-bottom");table.css("margin-bottom",0);var tableHeight=options.tableHeight;if(tableHeight<1){var rowHeight=table.find("tbody tr:first").outerHeight();tableHeight=rowHeight*10}var headerTable=$('<table style="table-layout:fixed;width:auto;margin-bottom:0;" class="jqstb-header-table '+existingClasses+'"><thead><tr><td></td></tr></thead></table>'),footerTable=$('<table style="table-layout:fixed;width:auto;margin-bottom:'+existingMarginBottom+';" class="jqstb-footer-table '+existingClasses+'"><tfoot><tr><td></td></tr></tfoot></table>'),scrollDiv='<div class="jqstb-scroll" style="height:'+tableHeight+'px;overflow-y:auto"></div>';table.before(headerTable).before(scrollDiv).after(footerTable)}function alignColumns(table){table.each(function(index){var $dataTable=$(this);var $headerTable=$("table.jqstb-header-table").eq(index);var $footerTable=$("table.jqstb-footer-table").eq(index);var $scrollDiv=$("div.jqstb-scroll").eq(index);$scrollDiv.prepend($dataTable);var scrollEl=$scrollDiv[0];var hasHorizontalScroll=scrollEl.clientWidth<scrollEl.scrollWidth;$scrollDiv.outerWidth(fixedTableWidth+scrollBarWidth+2);if(hasHorizontalScroll){var dataTableWidth=$dataTable.outerWidth();$headerTable.width(dataTableWidth);$footerTable.width(dataTableWidth);$scrollDiv.outerWidth(scrollEl.clientWidth);var scrollDivWidth=$scrollDiv.outerWidth();var width=scrollDivWidth-scrollBarWidth;var $headerScrollDiv=$('<div style="overflow:hidden;width:'+width+'px" class="jqstb-header-scroll"></div>');$headerTable.wrap($headerScrollDiv);var $footerScrollDiv=$('<div style="overflow:hidden;width:'+width+'px" class="jqstb-footer-scroll"></div>');$footerTable.wrap($footerScrollDiv);$scrollDiv.on("scroll",function(){$("div.jqstb-header-scroll").scrollLeft($(this).scrollLeft());$("div.jqstb-footer-scroll").scrollLeft($(this).scrollLeft())})}$dataTable.find("thead tr:first th, tbody tr:first td").each(function(){$(this).outerWidth($(this).outerWidth())});$headerTable.find("thead").replaceWith($dataTable.children("caption, thead").clone());$dataTable.find("tfoot tr:first td").each(function(){$(this).outerWidth($(this).outerWidth())});$footerTable.find("tfoot").replaceWith($dataTable.children("tfoot").clone());$dataTable.children("caption, thead, tfoot").hide()})}function alignOnResize(table){table.each(function(index){var $dataTable=$(this);var $headerTable=$("table.jqstb-header-table").eq(index);var $footerTable=$("table.jqstb-footer-table").eq(index);$dataTable.children("thead, tfoot").show();var scrollEl=$("div.jqstb-scroll")[0];var hasHorizontalScroll=scrollEl.clientWidth<scrollEl.scrollWidth;if(hasHorizontalScroll){var scrollDivWidth=$("div.jqstb-scroll").outerWidth();$("div.jqstb-header-scroll").outerWidth(scrollDivWidth-scrollBarWidth);$("div.jqstb-footer-scroll").outerWidth(scrollDivWidth-scrollBarWidth)}var $headerColumns=$headerTable.find("thead tr:first th");$dataTable.find("thead tr:first th").each(function(i){$headerColumns.eq(i).outerWidth($(this).outerWidth())});var $footerColumns=$footerTable.find("tfoot tr:first td");$dataTable.find("tfoot tr:first td").each(function(i){$footerColumns.eq(i).outerWidth($(this).outerWidth())});$dataTable.children("thead, tfoot").hide()})}})(jQuery);